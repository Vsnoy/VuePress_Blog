(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{470:function(s,a,t){"use strict";t.r(a);var n=t(14),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"执行上下文栈"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#执行上下文栈"}},[s._v("#")]),s._v(" 执行上下文栈")]),s._v(" "),t("h2",{attrs:{id:"执行上下文"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#执行上下文"}},[s._v("#")]),s._v(" 执行上下文")]),s._v(" "),t("p",[s._v("执行上下文分为三种：全局执行上下文 ( "),t("code",[s._v("globalContext")]),s._v(" )、函数执行上下文 ( "),t("code",[s._v("functionContext")]),s._v(" )、eval 执行上下文。")]),s._v(" "),t("p",[s._v("对于每个执行上下文，都有三个重要属性：")]),s._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"./%E4%BD%9C%E7%94%A8%E5%9F%9F%E9%93%BE"}},[s._v("作用域链")])]),s._v(" "),t("li",[t("a",{attrs:{href:"./%E5%8F%98%E9%87%8F%E5%AF%B9%E8%B1%A1"}},[s._v("变量对象")])]),s._v(" "),t("li",[t("a",{attrs:{href:"./this%20%E6%8C%87%E5%90%91"}},[s._v("this")])])]),s._v(" "),t("h3",{attrs:{id:"执行过程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#执行过程"}},[s._v("#")]),s._v(" 执行过程")]),s._v(" "),t("p",[s._v("一个执行上下文的生命周期可以分为两个阶段。")]),s._v(" "),t("ul",[t("li",[s._v("创建阶段：构建作用域链，创建变量对象，确定 "),t("code",[s._v("this")]),s._v(" 指向。")]),s._v(" "),t("li",[s._v("执行阶段：完成变量赋值和函数引用，解释执行代码。")])]),s._v(" "),t("h4",{attrs:{id:"创建阶段"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建阶段"}},[s._v("#")]),s._v(" 创建阶段")]),s._v(" "),t("p",[s._v("在执行代码之前，会先创建执行上下文并对其包含的属性进行初始化。")]),s._v(" "),t("ul",[t("li",[s._v("作用域链\n"),t("ul",[t("li",[s._v("复制函数内部属性 "),t("code",[s._v("[[scope]]")]),s._v(" 来构建作用域链")]),s._v(" "),t("li",[s._v("将变量（活动）对象压入其作用域链的顶端")])])]),s._v(" "),t("li",[s._v("变量对象\n"),t("ul",[t("li",[s._v("函数形参（仅限函数执行上下文）：如果没有实参，属性值设为 "),t("code",[s._v("undefined")]),s._v(" 。")]),s._v(" "),t("li",[s._v("函数声明：如果变量对象已经存在相同名称的属性，则完全 "),t("strong",[s._v("替换")]),s._v(" 这个属性。")]),s._v(" "),t("li",[s._v("变量声明：如果变量名称跟已经声明的形参或函数相同，则变量声明 "),t("strong",[s._v("不会干扰")]),s._v(" 已经存在的这类属性。")])])]),s._v(" "),t("li",[s._v("this\n"),t("ul",[t("li",[s._v("词法绑定")]),s._v(" "),t("li",[s._v("new 绑定")]),s._v(" "),t("li",[s._v("显式绑定")]),s._v(" "),t("li",[s._v("隐式绑定")]),s._v(" "),t("li",[s._v("默认绑定")])])])]),s._v(" "),t("h4",{attrs:{id:"执行阶段"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#执行阶段"}},[s._v("#")]),s._v(" 执行阶段")]),s._v(" "),t("p",[s._v("解释执行代码，在这个过程中不断修改变量对象中的属性值。")]),s._v(" "),t("h2",{attrs:{id:"执行上下文栈-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#执行上下文栈-2"}},[s._v("#")]),s._v(" 执行上下文栈")]),s._v(" "),t("p",[t("code",[s._v("JS")]),s._v(" 引擎创建了很多执行上下文，为了方便管理，创建了执行上下文栈 ( "),t("code",[s._v("Execution Context Stack")]),s._v("，"),t("code",[s._v("ECS")]),s._v(" ) 。")]),s._v(" "),t("p",[s._v("初始化时，最先碰到的就是全局代码，因而会向执行上下文栈压入一个全局执行上下文。程序执行完毕，执行栈清空，就会将最底部的全局执行上下文从栈中弹出。")]),s._v(" "),t("p",[s._v("遇到函数执行时，会向执行上下文栈压入一个函数执行上下文。函数执行完毕，就会将函数的执行上下文从栈中弹出。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://raw.githubusercontent.com/Vsnoy/PicGo/main/VuePress/excution_context_stack.jpg",alt:"excution_context_stack"}})]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("TIP")]),s._v(" "),t("p",[s._v("具体执行分析可参考冴羽大大的\n"),t("a",{attrs:{href:"https://github.com/mqyqingfeng/Blog/blob/master/articles/%E6%B7%B1%E5%85%A5%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0/JavaScript%E6%B7%B1%E5%85%A5%E4%B9%8B%E6%89%A7%E8%A1%8C%E4%B8%8A%E4%B8%8B%E6%96%87.md#%E5%85%B7%E4%BD%93%E6%89%A7%E8%A1%8C%E5%88%86%E6%9E%90",target:"_blank",rel:"noopener noreferrer"}},[s._v("JavaScript 深入之执行上下文"),t("OutboundLink")],1)])]),s._v(" "),t("h2",{attrs:{id:"概念区别"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#概念区别"}},[s._v("#")]),s._v(" 概念区别")]),s._v(" "),t("div",{staticClass:"custom-block warning"},[t("p",{staticClass:"custom-block-title"},[s._v("WARNING")]),s._v(" "),t("p",[s._v("个人理解，可能不够准确，有待推敲。")])]),s._v(" "),t("h3",{attrs:{id:"作用域和变量对象"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#作用域和变量对象"}},[s._v("#")]),s._v(" 作用域和变量对象")]),s._v(" "),t("p",[s._v("作用域 ≈ 变量对象"),t("br"),s._v("\n两者基本是一个概念")]),s._v(" "),t("h3",{attrs:{id:"作用域和执行上下文"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#作用域和执行上下文"}},[s._v("#")]),s._v(" 作用域和执行上下文")]),s._v(" "),t("ul",[t("li",[s._v("执行上下文 > 作用域")]),s._v(" "),t("li",[s._v("执行上下文 = 变量对象 + 作用域链 + this")]),s._v(" "),t("li",[s._v("作用域链 = 变量对象 + 父环境作用域链")]),s._v(" "),t("li",[s._v("作用域 ≈ 变量对象")])]),s._v(" "),t("h3",{attrs:{id:"作用域链和执行上下文区别"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#作用域链和执行上下文区别"}},[s._v("#")]),s._v(" 作用域链和执行上下文区别")]),s._v(" "),t("ul",[t("li",[s._v("作用域链用于查找变量")]),s._v(" "),t("li",[s._v("执行上下文栈用于管理执行上下文")])]),s._v(" "),t("h3",{attrs:{id:"执行上下文栈和调用栈"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#执行上下文栈和调用栈"}},[s._v("#")]),s._v(" 执行上下文栈和调用栈")]),s._v(" "),t("p",[s._v("同一个东西")]),s._v(" "),t("h2",{attrs:{id:"思考题"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#思考题"}},[s._v("#")]),s._v(" 思考题")]),s._v(" "),t("p",[s._v("根据闭包和词法作用域的知识，我们知道以下两个案例的结果是一样的。那么这两段代码究竟有何不同呢？答案就是执行上下文栈的变化不一样。")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("var scope = 'global scope'\nfunction checkscope() {\n  var scope = 'local scope'\n  function f() {\n    return scope\n }\n  return f()\n}\ncheckscope()\n\n// 执行上下文栈变化\nECStack.push(<checkscope> functionContext)\nECStack.push(<f> functionContext)\nECStack.pop() \nECStack.pop()\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br")]),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br")])]),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("var scope = 'global scope'\nfunction checkscope ( ) {\n  var scope = 'local scope'\n  function f() {\n    return scope\n }\n  return f\n}\ncheckscope()()\n\n// 执行上下文栈变化\nECStack.push(<checkscope> functionContext)\nECStack.pop()\nECStack.push(<f> functionContext)\nECStack.pop()\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br")]),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br")])]),t("h2",{attrs:{id:"参考"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[s._v("#")]),s._v(" 参考")]),s._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://github.com/mqyqingfeng/Blog/issues/8",target:"_blank",rel:"noopener noreferrer"}},[s._v("JavaScript 深入之执行上下文"),t("OutboundLink")],1)]),s._v(" "),t("li",[t("a",{attrs:{href:"https://github.com/mqyqingfeng/Blog/issues/4",target:"_blank",rel:"noopener noreferrer"}},[s._v("JavaScript 深入之执行上下文栈"),t("OutboundLink")],1)]),s._v(" "),t("li",[t("a",{attrs:{href:"https://github.com/CoolRabbit520/blog/issues/5",target:"_blank",rel:"noopener noreferrer"}},[s._v("执行上下文和作用域"),t("OutboundLink")],1)])])])}),[],!1,null,null,null);a.default=e.exports}}]);